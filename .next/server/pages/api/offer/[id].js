"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/offer/[id]";
exports.ids = ["pages/api/offer/[id]"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "eth-sig-util":
/*!*******************************!*\
  !*** external "eth-sig-util" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("eth-sig-util");

/***/ }),

/***/ "(api)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"prisma\": () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nlet prisma;\nif (false) {} else {\n    const g = global;\n    if (!g.prisma) g.prisma = new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\n    prisma = g.prisma;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHJpc21hLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxJQUFJQztBQUVKLElBQUlDLEtBQXlCLEVBQWMsRUFFMUMsTUFBTTtJQUNMLE1BQU1DLElBQUlDO0lBQ1YsSUFBSSxDQUFDRCxFQUFFRixNQUFNLEVBQUVFLEVBQUVGLE1BQU0sR0FBRyxJQUFJRCx3REFBWUE7SUFDMUNDLFNBQVNFLEVBQUVGLE1BQU07QUFDbkIsQ0FBQztBQUVpQiIsInNvdXJjZXMiOlsid2VicGFjazovL29zaWduLnNoLy4vbGliL3ByaXNtYS50cz85ODIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcblxubGV0IHByaXNtYTogUHJpc21hQ2xpZW50O1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICBwcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG59IGVsc2Uge1xuICBjb25zdCBnID0gZ2xvYmFsIGFzIGFueTtcbiAgaWYgKCFnLnByaXNtYSkgZy5wcmlzbWEgPSBuZXcgUHJpc21hQ2xpZW50KCk7XG4gIHByaXNtYSA9IGcucHJpc21hO1xufVxuXG5leHBvcnQgeyBwcmlzbWEgfTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJwcm9jZXNzIiwiZyIsImdsb2JhbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/prisma.ts\n");

/***/ }),

/***/ "(api)/./pages/api/offer/[id].ts":
/*!*********************************!*\
  !*** ./pages/api/offer/[id].ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../lib/prisma */ \"(api)/./lib/prisma.ts\");\n/* harmony import */ var eth_sig_util__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! eth-sig-util */ \"eth-sig-util\");\n/* harmony import */ var eth_sig_util__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(eth_sig_util__WEBPACK_IMPORTED_MODULE_1__);\n// Next.js API route support: https://nextjs.org/docs/api-routes/introduction\n\n\nasync function handler(req, res) {\n    if (req.method == \"GET\") {\n        const offer = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.offers.findMany({\n            where: {\n                id: req.query.id\n            }\n        });\n        if (offer) {\n            res.status(200).json({\n                data: offer\n            });\n        } else {\n            res.status(404).json({\n                message: \"offer not found\"\n            });\n        }\n    } else if (req.method == \"PUT\") {\n        // 更新签名\n        const signer = req.body.signer;\n        const signature = req.body.signature;\n        const id = req.query.id;\n        const data = req.body.data;\n        if (!signer) {\n            return res.status(400).json({\n                message: \"Missing signer\"\n            });\n        }\n        if (!signature) {\n            return res.status(400).json({\n                message: \"Missing signature\"\n            });\n        }\n        const offer1 = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.offers.findFirst({\n            where: {\n                id: id\n            }\n        });\n        console.log(offer1);\n        if (!offer1) {\n            return res.status(404).json({\n                message: \"offer not found\"\n            });\n        }\n        if (!offer1.signers.includes(signer)) {\n            return res.status(400).json({\n                message: \"not valid signer\"\n            });\n        }\n        if (offer1.expiresAt < new Date()) {\n            return res.status(400).json({\n                message: \"offer expired\"\n            });\n        }\n        //@ts-ignore\n        if (offer1.signdata && offer1.signdata[signer]) {\n            return res.status(400).json({\n                message: \"already signed\"\n            });\n        }\n        try {\n            const recoveredAddr = (0,eth_sig_util__WEBPACK_IMPORTED_MODULE_1__.recoverPersonalSignature)({\n                data: `I am sign for the offer: ${id} \\nOffer detail: ${JSON.stringify(offer1.staticData, null, 2)} \\nWallet address:${signer}.`,\n                sig: signature\n            });\n            console.log(`I am sign for the offer: ${id} \\nOffer detail: ${JSON.stringify(offer1.staticData, null, 2)} \\nWallet address:${signer}.`);\n            console.log(recoveredAddr, signer, signature);\n            if (!recoveredAddr || recoveredAddr.toLowerCase() != signer.toLowerCase()) {\n                return res.status(400).json({\n                    message: \"invalid signature\"\n                });\n            }\n            let signdata = offer1.signdata;\n            if (!signdata) {\n                signdata = {};\n            }\n            signdata = {\n                ...signdata,\n                [signer]: signature\n            };\n            // 写入扩展数据\n            let extData = offer1.extData;\n            if (!extData) {\n                extData = {};\n            } else {\n                for(let key in data){\n                    // 不能覆盖已有字段，只能增量写入新的字段\n                    if (extData[key] == undefined) {\n                        extData[key] = data[key];\n                    }\n                }\n            }\n            // 检查是否签名完毕\n            let allSigned = false;\n            if (offer1.signers.length == Object.keys(signdata).length) {\n                allSigned = true;\n            }\n            const offers = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.offers.update({\n                where: {\n                    id: id\n                },\n                data: {\n                    extData: extData,\n                    signdata,\n                    ...allSigned ? {\n                        status: 2\n                    } : {}\n                }\n            });\n            res.status(200).json({\n                data: offers\n            });\n        } catch (e) {\n            console.log(e);\n            res.status(400).json({\n                message: \"update offer error: \" + e.message\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O2dCQUFFRSxTQUFTLHlCQUF5QjBCLEVBQUUxQixPQUFPO1lBQUM7UUFDckU7SUFDRixDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL29zaWduLnNoLy4vcGFnZXMvYXBpL29mZmVyL1tpZF0udHM/YTAyNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBOZXh0LmpzIEFQSSByb3V0ZSBzdXBwb3J0OiBodHRwczovL25leHRqcy5vcmcvZG9jcy9hcGktcm91dGVzL2ludHJvZHVjdGlvblxuaW1wb3J0IHsgUHJpc21hIH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuaW1wb3J0IHR5cGUgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi8uLi8uLi9saWIvcHJpc21hJztcbmltcG9ydCB7IHJlY292ZXJQZXJzb25hbFNpZ25hdHVyZSB9IGZyb20gJ2V0aC1zaWctdXRpbCc7XG50eXBlIERhdGEgPSB7XG4gIG5hbWU6IHN0cmluZztcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXG4gIHJlcTogTmV4dEFwaVJlcXVlc3QsXG4gIHJlczogTmV4dEFwaVJlc3BvbnNlLFxuKSB7XG4gIGlmIChyZXEubWV0aG9kID09ICdHRVQnKSB7XG4gICAgY29uc3Qgb2ZmZXIgPSBhd2FpdCBwcmlzbWEub2ZmZXJzLmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGlkOiByZXEucXVlcnkuaWQgYXMgc3RyaW5nLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICBpZiAob2ZmZXIpIHtcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgZGF0YTogb2ZmZXIsXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiAnb2ZmZXIgbm90IGZvdW5kJyB9KTtcbiAgICB9XG4gIH0gZWxzZSBpZiAocmVxLm1ldGhvZCA9PSAnUFVUJykge1xuICAgIC8vIOabtOaWsOetvuWQjVxuICAgIGNvbnN0IHNpZ25lciA9IHJlcS5ib2R5LnNpZ25lcjtcbiAgICBjb25zdCBzaWduYXR1cmUgPSByZXEuYm9keS5zaWduYXR1cmU7XG4gICAgY29uc3QgaWQgPSByZXEucXVlcnkuaWQgYXMgc3RyaW5nO1xuICAgIGNvbnN0IGRhdGEgPSByZXEuYm9keS5kYXRhO1xuXG4gICAgaWYgKCFzaWduZXIpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdNaXNzaW5nIHNpZ25lcicgfSk7XG4gICAgfVxuICAgIGlmICghc2lnbmF0dXJlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnTWlzc2luZyBzaWduYXR1cmUnIH0pO1xuICAgIH1cbiAgICBjb25zdCBvZmZlciA9IGF3YWl0IHByaXNtYS5vZmZlcnMuZmluZEZpcnN0KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGlkOiBpZCxcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2cob2ZmZXIpO1xuICAgIGlmICghb2ZmZXIpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IG1lc3NhZ2U6ICdvZmZlciBub3QgZm91bmQnIH0pO1xuICAgIH1cbiAgICBpZiAoIW9mZmVyLnNpZ25lcnMuaW5jbHVkZXMoc2lnbmVyKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ25vdCB2YWxpZCBzaWduZXInIH0pO1xuICAgIH1cbiAgICBpZiAob2ZmZXIuZXhwaXJlc0F0IDwgbmV3IERhdGUoKSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ29mZmVyIGV4cGlyZWQnIH0pO1xuICAgIH1cblxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGlmIChvZmZlci5zaWduZGF0YSAmJiBvZmZlci5zaWduZGF0YVtzaWduZXJdKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnYWxyZWFkeSBzaWduZWQnIH0pO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZWNvdmVyZWRBZGRyID0gcmVjb3ZlclBlcnNvbmFsU2lnbmF0dXJlKHtcbiAgICAgICAgZGF0YTogYEkgYW0gc2lnbiBmb3IgdGhlIG9mZmVyOiAke2lkfSBcXG5PZmZlciBkZXRhaWw6ICR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgICAgb2ZmZXIuc3RhdGljRGF0YSxcbiAgICAgICAgICBudWxsLFxuICAgICAgICAgIDIsXG4gICAgICAgICl9IFxcbldhbGxldCBhZGRyZXNzOiR7c2lnbmVyfS5gLFxuICAgICAgICBzaWc6IHNpZ25hdHVyZSxcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGBJIGFtIHNpZ24gZm9yIHRoZSBvZmZlcjogJHtpZH0gXFxuT2ZmZXIgZGV0YWlsOiAke0pTT04uc3RyaW5naWZ5KFxuICAgICAgICAgIG9mZmVyLnN0YXRpY0RhdGEsXG4gICAgICAgICAgbnVsbCxcbiAgICAgICAgICAyLFxuICAgICAgICApfSBcXG5XYWxsZXQgYWRkcmVzczoke3NpZ25lcn0uYCxcbiAgICAgICk7XG4gICAgICBjb25zb2xlLmxvZyhyZWNvdmVyZWRBZGRyLCBzaWduZXIsIHNpZ25hdHVyZSk7XG4gICAgICBpZiAoXG4gICAgICAgICFyZWNvdmVyZWRBZGRyIHx8XG4gICAgICAgIHJlY292ZXJlZEFkZHIudG9Mb3dlckNhc2UoKSAhPSBzaWduZXIudG9Mb3dlckNhc2UoKVxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdpbnZhbGlkIHNpZ25hdHVyZScgfSk7XG4gICAgICB9XG4gICAgICBsZXQgc2lnbmRhdGEgPSBvZmZlci5zaWduZGF0YSBhcyBQcmlzbWEuSnNvbk9iamVjdDtcbiAgICAgIGlmICghc2lnbmRhdGEpIHtcbiAgICAgICAgc2lnbmRhdGEgPSB7fTtcbiAgICAgIH1cbiAgICAgIHNpZ25kYXRhID0ge1xuICAgICAgICAuLi5zaWduZGF0YSxcbiAgICAgICAgW3NpZ25lcl06IHNpZ25hdHVyZSxcbiAgICAgIH07XG5cbiAgICAgIC8vIOWGmeWFpeaJqeWxleaVsOaNrlxuICAgICAgbGV0IGV4dERhdGEgPSBvZmZlci5leHREYXRhIGFzIFByaXNtYS5Kc29uT2JqZWN0O1xuICAgICAgaWYgKCFleHREYXRhKSB7XG4gICAgICAgIGV4dERhdGEgPSB7fTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAobGV0IGtleSBpbiBkYXRhKSB7XG4gICAgICAgICAgLy8g5LiN6IO96KaG55uW5bey5pyJ5a2X5q6177yM5Y+q6IO95aKe6YeP5YaZ5YWl5paw55qE5a2X5q61XG4gICAgICAgICAgaWYgKGV4dERhdGFba2V5XSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGV4dERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8g5qOA5p+l5piv5ZCm562+5ZCN5a6M5q+VXG4gICAgICBsZXQgYWxsU2lnbmVkID0gZmFsc2U7XG4gICAgICBpZiAob2ZmZXIuc2lnbmVycy5sZW5ndGggPT0gT2JqZWN0LmtleXMoc2lnbmRhdGEpLmxlbmd0aCkge1xuICAgICAgICBhbGxTaWduZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBvZmZlcnMgPSBhd2FpdCBwcmlzbWEub2ZmZXJzLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgaWQ6IGlkLFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgZXh0RGF0YTogZXh0RGF0YSxcbiAgICAgICAgICBzaWduZGF0YSxcbiAgICAgICAgICAuLi4oYWxsU2lnbmVkID8geyBzdGF0dXM6IDIgfSA6IHt9KSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIGRhdGE6IG9mZmVycyxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICd1cGRhdGUgb2ZmZXIgZXJyb3I6ICcgKyBlLm1lc3NhZ2UgfSk7XG4gICAgfVxuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwicmVjb3ZlclBlcnNvbmFsU2lnbmF0dXJlIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsIm9mZmVyIiwib2ZmZXJzIiwiZmluZE1hbnkiLCJ3aGVyZSIsImlkIiwicXVlcnkiLCJzdGF0dXMiLCJqc29uIiwiZGF0YSIsIm1lc3NhZ2UiLCJzaWduZXIiLCJib2R5Iiwic2lnbmF0dXJlIiwiZmluZEZpcnN0IiwiY29uc29sZSIsImxvZyIsInNpZ25lcnMiLCJpbmNsdWRlcyIsImV4cGlyZXNBdCIsIkRhdGUiLCJzaWduZGF0YSIsInJlY292ZXJlZEFkZHIiLCJKU09OIiwic3RyaW5naWZ5Iiwic3RhdGljRGF0YSIsInNpZyIsInRvTG93ZXJDYXNlIiwiZXh0RGF0YSIsImtleSIsInVuZGVmaW5lZCIsImFsbFNpZ25lZCIsImxlbmd0aCIsIk9iamVjdCIsImtleXMiLCJ1cGRhdGUiLCJlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/offer/[id].ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/offer/[id].ts"));
module.exports = __webpack_exports__;

})();